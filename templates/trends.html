{% extends "base.html" %}

{% block title %}Trends - Health Tracker{% endblock %}

{% block extra_styles %}
<style>
    [data-theme="light"] .chart {
        background: #ffffff;
        border-color: #dfe3e9;
    }

    .charts-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
    }

    @media (max-width: 968px) {
        .charts-grid {
            grid-template-columns: 1fr;
        }
    }

    /* Important: give Plotly containers a height */
    #weightChart,
    #bodyFatChart,
    #stepsChart,
    #sleepChart,
    #caloriesChart,
    #trainingVolumeChart {
        height: 340px;
    }

    /* === Stats panel === */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 14px;
        margin: 18px 0 24px 0;
    }

    .stat-card {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 12px;
        padding: 12px 14px;
    }

    .stat-card .label {
        display: block;
        font-size: 0.85rem;
        opacity: 0.7;
        margin-bottom: 6px;
    }

    .stat-card .value {
        font-size: 1.2rem;
        font-weight: 600;
    }

    .controls {
        margin: 8px 0 16px 0;
    }

    /* Trends page scrollbar (theme-aware) */
    .main-content {
        scrollbar-color: #3a3a3a #101214;
    }

    .main-content::-webkit-scrollbar {
        width: 10px;
    }

    .main-content::-webkit-scrollbar-track {
        background: #101214;
    }

    .main-content::-webkit-scrollbar-thumb {
        background: #3a3a3a;
        border-radius: 8px;
    }

    [data-theme="light"] .main-content {
        scrollbar-color: #c8d3dc #eef3f7;
    }

    [data-theme="light"] .main-content::-webkit-scrollbar-track {
        background: #eef3f7;
    }

    [data-theme="light"] .main-content::-webkit-scrollbar-thumb {
        background: #c8d3dc;
    }
</style>

{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Trends</h1>
    <p>Daily trends together with a weekly average (continuous line)</p>
</div>
<!-- Data controls-->
<div class="controls" style="margin: 12px 0 18px 0; display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
    <label for="windowSelect"><strong>Temporal window:</strong></label>
    <select id="windowSelect">
        <option value="7d">Last 7 days</option>
        <option value="30d">Last 30 days</option>
        <option value="3m" selected>Last 3 months</option>
        <option value="6m">Last 6 months</option>
        <option value="1y">Last 12 months</option>
        <option value="">All time</option>
    </select>

    <span id="windowMeta" style="opacity:.8;"></span>
</div>

<!-- Cards with average statistics-->
<div class="stats-grid" id="statsGrid">
    <div class="stat-card">
        <span class="label">Avg Weight (kg)</span>
        <span class="value" id="stat-avg_weight">--</span>
    </div>

    <div class="stat-card">
        <span class="label">Avg Body Fat (%)</span>
        <span class="value" id="stat-avg_body_fat">--</span>
    </div>

    <div class="stat-card">
        <span class="label">Avg Steps</span>
        <span class="value" id="stat-avg_steps">--</span>
    </div>

    <div class="stat-card">
        <span class="label">Avg Sleep (HH:MM)</span>
        <span class="value" id="stat-avg_sleep">--</span>
    </div>

    <div class="stat-card">
        <span class="label">Avg Calories (kcal) </span>
        <span class="value" id="stat-avg_calories">--</span>
    </div>
</div>



<!-- Cards with Plotty graphs-->
<div class="charts-grid">
    <div class="chart">
        <h2>Body Weight</h2>
        <div id="weightChart"></div>
    </div>

    <div class="chart">
        <h2>Body Fat Percentage</h2>
        <div id="bodyFatChart"></div>
    </div>
</div>

<div class="charts-grid">
    <div class="chart">
        <h2>Daily Steps</h2>
        <div id="stepsChart"></div>
    </div>

    <div class="chart">
        <h2>Sleep Total</h2>
        <div id="sleepChart"></div>
    </div>
</div>

<div class="charts-grid">
    <div class="chart">
        <h2>Daily Calories</h2>
        <div id="caloriesChart"></div>
    </div>
    <div class="chart">
        <h2>Training Volume</h2>
        <div id="trainingVolumeChart"></div>
    </div>
</div>
{% endblock %}
